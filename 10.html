<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>49-Day Study Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #f8fafc;
      color: #222;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      margin: 0;
    }

    h1 {
      color: #ff4500;
      margin-bottom: 20px;
    }

    .chart-container {
      width: 90%;
      max-width: 700px;
      margin-bottom: 25px;
      background: #fff;
      padding: 15px;
      border-radius: 15px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 15px;
      width: 90%;
      max-width: 1000px;
    }

    .day-card {
      background: #fff;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      text-align: center;
      border: 3px solid transparent;
    }

    .day-card.completed {
      background: #d1fae5;
      border-color: #10b981;
      text-decoration: line-through;
    }

    .day-card:hover {
      transform: scale(1.04);
    }

    .subject {
      font-weight: 600;
      color: #2563eb;
      margin-top: 5px;
    }

    .lesson {
      color: #7c3aed;
      font-weight: 500;
    }

    button {
      margin-top: 10px;
      background: #2563eb;
      color: #fff;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background: #1e3a8a;
    }

    .completed button {
      background: #ef4444;
    }

    @media (max-width: 600px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <h1>ðŸ“˜ 49-Day Study Tracker</h1>

  <div class="chart-container">
    <canvas id="progressChart"></canvas>
  </div>

  <div class="grid" id="dayGrid"></div>

  <script>
    const totalDays = 49;
    const mainSubjects = ["AOR", "FLAT"];
    const extraSubjects = ["DWDM", "CN", "AI"];
    const lessonsPerSubject = 5;

    const completedDays = JSON.parse(localStorage.getItem("completedDays")) || [];
    const progress = JSON.parse(localStorage.getItem("progress")) || {
      AOR: 0, FLAT: 0, DWDM: 0, CN: 0, AI: 0
    };

    const grid = document.getElementById("dayGrid");

    // Generate 49-day plan
    for (let i = 1; i <= totalDays; i++) {
      const dayCard = document.createElement("div");
      dayCard.classList.add("day-card");

      // Main subject pattern (3 AOR â†’ 3 FLAT â†’ repeat)
      const block = Math.floor((i - 1) / 3);
      const mainSubject = mainSubjects[block % 2];

      // Extra subject cycle (DWDM â†’ CN â†’ AI â†’ repeat)
      const extraSubject = extraSubjects[(i - 1) % extraSubjects.length];

      // Lesson numbers
      const mainLesson = ((Math.floor((i - 1) / 3)) % lessonsPerSubject) + 1;
      const extraLesson = ((i - 1) % lessonsPerSubject) + 1;

      // Revision check
      const mainText = (block >= lessonsPerSubject)
        ? `Revision (Lesson ${(mainLesson)})`
        : `Lesson ${mainLesson}`;
      const extraText = (Math.floor((i - 1) / extraSubjects.length) >= lessonsPerSubject)
        ? `Revision (Lesson ${(extraLesson)})`
        : `Lesson ${extraLesson}`;

      if (completedDays.includes(i)) {
        dayCard.classList.add("completed");
      }

      dayCard.innerHTML = `
        <h2>Day ${i}</h2>
        <p><strong>Main:</strong> ${mainSubject}</p>
        <p class="lesson">${mainText}</p>
        <p class="subject"><strong>Extra:</strong> ${extraSubject}</p>
        <p class="lesson">${extraText}</p>
        <button>${completedDays.includes(i) ? "Unmark" : "Mark Complete"}</button>
      `;

      const btn = dayCard.querySelector("button");
      btn.addEventListener("click", () => toggleComplete(i, mainSubject, extraSubject, dayCard, btn));
      grid.appendChild(dayCard);
    }

    function toggleComplete(day, main, extra, card, btn) {
      const index = completedDays.indexOf(day);
      if (index === -1) {
        completedDays.push(day);
        card.classList.add("completed");
        btn.textContent = "Unmark";

        progress[main]++;
        progress[extra]++;
      } else {
        completedDays.splice(index, 1);
        card.classList.remove("completed");
        btn.textContent = "Mark Complete";

        progress[main]--;
        progress[extra]--;
      }

      localStorage.setItem("completedDays", JSON.stringify(completedDays));
      localStorage.setItem("progress", JSON.stringify(progress));
      updateChart();
    }

    // Bar chart
    const ctx = document.getElementById("progressChart");
    const chart = new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["AOR", "FLAT", "DWDM", "CN", "AI"],
        datasets: [{
          label: "Progress (Days Completed)",
          data: [progress.AOR, progress.FLAT, progress.DWDM, progress.CN, progress.AI],
          backgroundColor: ["#f87171", "#fbbf24", "#34d399", "#60a5fa", "#a78bfa"]
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            max: totalDays / 2
          }
        }
      }
    });

    function updateChart() {
      chart.data.datasets[0].data = [progress.AOR, progress.FLAT, progress.DWDM, progress.CN, progress.AI];
      chart.update();
    }

    updateChart();
  </script>
</body>
</html>
